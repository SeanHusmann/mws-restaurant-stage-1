"use strict";var map,interactiveMapHasLoaded=!1,restaurants=void 0,neighborhoods=void 0,cuisines=void 0,restaurantImagesIntersectionObserver=void 0,markers=[];IntersectionObserver&&(restaurantImagesIntersectionObserver=new IntersectionObserver(function(e){e.forEach(function(e){var t=e.target;if(e.intersectionRatio>0){var a=""+["180w","304w","428w","552w","676w","800w"].map(function(e){return"img/"+t.getAttribute("restaurant-id")+"-"+e+".jpg "+e}).join(", ");t.setAttribute("srcset",a),t.setAttribute("sizes","(max-width: 499px) calc(100vw - 34px), (max-width: 799px) calc((100vw - 3 * 20px - 2 * 34px) / 2), (max-width: 1023px) calc((100vw - 4 * 20px - 3 * 34px) / 3), (min-width: 1024px) 281px"),t.src="img/"+t.getAttribute("restaurant-id")+"-552w.jpg",restaurantImagesIntersectionObserver.unobserve(t)}})})),registerServiceWorker=function(){navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js")},registerServiceWorker(),fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=arguments.length<=0||void 0===arguments[0]?self.neighborhoods:arguments[0],t=document.getElementById("neighborhoods-select");e.forEach(function(e){var a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=arguments.length<=0||void 0===arguments[0]?self.cuisines:arguments[0],t=document.getElementById("cuisines-select");e.forEach(function(e){var a=document.createElement("option");a.innerHTML=e,a.value=e,t.append(a)})},window.initMap=function(){self.map=new google.maps.Map(document.getElementsByClassName("map")[0],{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),self.restaurants?addMarkersToMap():updateRestaurants()},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),a=e.selectedIndex,n=t.selectedIndex,r=e[a].value,s=t[n].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,s,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},resetRestaurants=function(e){self.restaurants=[];document.getElementsByClassName("restaurants-list")[0].innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e,!1===interactiveMapHasLoaded&&updateGoogleMapsPreviewImage(e)},updateGoogleMapsPreviewImage=function(e){var t=document.querySelector(".map-overlay"),a=document.querySelector(".map"),n=document.querySelector(".map-preview");t.onclick=function(){t.style.display="none",t.parentNode.removeChild(t),a.style.display="block",interactiveMapHasLoaded=!0,self.map&&google.maps.event.addDomListenerOnce(self.map,"tilesloaded",function(){n.parentNode.removeChild(n),a.style.position="relative"})};var r=window.getComputedStyle(a),s=Math.trunc(window.innerWidth),o=Math.trunc(r.height.replace("px","")),i="";e.forEach(function(e){i+="&markers=size:%7Ccolor:0xff0000%7Clabel:%7C"+e.latlng.lat+",+"+e.latlng.lng}),n.src="https://maps.googleapis.com/maps/api/staticmap?center=40.722216,+-73.987501&zoom=12&scale=1&size="+s+"x"+o+"&maptype=roadmap&format=jpg&visual_refresh=true"+i+"&key=AIzaSyD7U9qcVcdpFFnhE9Gj7fJ87TU6SbL0OoE "},fillRestaurantsHTML=function(){var e=arguments.length<=0||void 0===arguments[0]?self.restaurants:arguments[0],t=document.getElementsByClassName("restaurants-list")[0];e.forEach(function(e){t.append(createRestaurantHTML(e))}),self.map&&addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("li"),a=document.createElement("header");a.className="restaurant-header",t.append(a);var n=document.createElement("img");if(n.className="restaurant-img",n.setAttribute("restaurant-id",e.id),restaurantImagesIntersectionObserver)restaurantImagesIntersectionObserver.observe(n);else{var r=""+["180w","304w","428w","552w","676w","800w"].map(function(t){return"img/"+e.id+"-"+t+".jpg "+t}).join(", ");n.setAttribute("srcset",r),n.setAttribute("sizes","(max-width: 614px) calc(100vw - 2 * 36px), (max-width: 1189px) calc((100vw - 3 * 35px - 2 * 2px) / 2), (max-width: 1399px) calc((100vw - 4 * 35px - 3 * 2px) / 3), (min-width: 1400px) 409px"),n.src="img/"+e.id+"-552w.jpg"}n.alt=e.name+" Restaurant",a.append(n);var s=document.createElement("h2");s.innerHTML=e.name,s.id="restaurant-"+e.id+"-name",a.append(s);var o=document.createElement("p");o.innerHTML=e.neighborhood,t.append(o);var i=document.createElement("p");i.innerHTML=e.address,t.append(i);var c=document.createElement("a");return c.innerHTML="View Details",c.setAttribute("aria-labelledby",s.id),c.href=DBHelper.urlForRestaurant(e),t.append(c),t},addMarkersToMap=function(){(arguments.length<=0||void 0===arguments[0]?self.restaurants:arguments[0]).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})},document.getElementById("neighborhoods-select").onchange=updateRestaurants,document.getElementById("cuisines-select").onchange=updateRestaurants,loadAllRestaurantsJSONAndPopulateFiltersAndRestaurantsListHTML=function(){DBHelper.fetchRestaurants(function(e,t){e?console.error(e):(fetchNeighborhoods(),fetchCuisines(),resetRestaurants(t),fillRestaurantsHTML())})},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(e){loadAllRestaurantsJSONAndPopulateFiltersAndRestaurantsListHTML()}):loadAllRestaurantsJSONAndPopulateFiltersAndRestaurantsListHTML(),document.getElementById("gmaps-script-element").src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD7U9qcVcdpFFnhE9Gj7fJ87TU6SbL0OoE &libraries=places&callback=initMap";